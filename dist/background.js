// src/shared/constants.ts
var STORAGE_KEYS = {
  TRACKMAN_DATA: "trackmanData"
};

// src/background/serviceWorker.ts
chrome.runtime.onInstalled.addListener(() => {
  console.log("Trackman Scraper extension installed");
});
function getDownloadErrorMessage(originalError) {
  if (originalError.includes("invalid")) {
    return "Invalid download format";
  }
  if (originalError.includes("quota") || originalError.includes("space")) {
    return "Insufficient storage space";
  }
  if (originalError.includes("blocked") || originalError.includes("policy")) {
    return "Download blocked by browser settings";
  }
  return originalError;
}
chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
  if (message.type === "GET_DATA") {
    chrome.storage.local.get([STORAGE_KEYS.TRACKMAN_DATA], (result) => {
      sendResponse(result[STORAGE_KEYS.TRACKMAN_DATA] || null);
    });
    return true;
  }
  if (message.type === "EXPORT_CSV") {
    chrome.downloads.download(
      {
        url: `data:text/csv;charset=utf-8,${encodeURIComponent(message.csvContent)}`,
        filename: message.filename,
        saveAs: false
      },
      (downloadId) => {
        if (chrome.runtime.lastError) {
          console.error("Trackman Scraper: Download failed:", chrome.runtime.lastError);
          const errorMessage = getDownloadErrorMessage(chrome.runtime.lastError.message);
          sendResponse({ success: false, error: errorMessage });
        } else {
          console.log(`Trackman Scraper: CSV exported with download ID ${downloadId}`);
          sendResponse({ success: true, downloadId });
        }
      }
    );
    return true;
  }
});
chrome.storage.onChanged.addListener((changes, namespace) => {
  if (namespace === "local" && changes[STORAGE_KEYS.TRACKMAN_DATA]) {
    const newValue = changes[STORAGE_KEYS.TRACKMAN_DATA].newValue;
    chrome.runtime.sendMessage({ type: "DATA_UPDATED", data: newValue });
  }
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL3NoYXJlZC9jb25zdGFudHMudHMiLCAiLi4vc3JjL2JhY2tncm91bmQvc2VydmljZVdvcmtlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyoqXG4gKiBTaGFyZWQgY29uc3RhbnRzIGluY2x1ZGluZyBDU1Mgc2VsZWN0b3JzIGFuZCBjb25maWd1cmF0aW9uLlxuICogQmFzZWQgb24gUHl0aG9uIHNjcmFwZXIgY29uc3RhbnRzLnB5IGltcGxlbWVudGF0aW9uLlxuICovXG5cbi8vIENvbXBsZXRlIGxpc3Qgb2YgYWxsIGtub3duIFRyYWNrbWFuIG1ldHJpY3MgKFVSTCBwYXJhbWV0ZXIgbmFtZXMpXG5leHBvcnQgY29uc3QgQUxMX01FVFJJQ1MgPSBbXG4gIFwiQ2x1YlNwZWVkXCIsXG4gIFwiQmFsbFNwZWVkXCIsXG4gIFwiU21hc2hGYWN0b3JcIixcbiAgXCJBdHRhY2tBbmdsZVwiLFxuICBcIkNsdWJQYXRoXCIsXG4gIFwiRmFjZUFuZ2xlXCIsXG4gIFwiRmFjZVRvUGF0aFwiLFxuICBcIlN3aW5nRGlyZWN0aW9uXCIsXG4gIFwiRHluYW1pY0xvZnRcIixcbiAgXCJTcGluUmF0ZVwiLFxuICBcIlNwaW5BeGlzXCIsXG4gIFwiQ2FycnlcIixcbiAgXCJUb3RhbFwiLFxuICBcIlNpZGVcIixcbiAgXCJTaWRlVG90YWxcIixcbiAgXCJIZWlnaHRcIixcbiAgXCJMb3dQb2ludERpc3RhbmNlXCIsXG4gIFwiSW1wYWN0SGVpZ2h0XCIsXG4gIFwiSW1wYWN0T2Zmc2V0XCIsXG4gIFwiVGVtcG9cIixcbl0gYXMgY29uc3Q7XG5cbi8vIE1ldHJpY3Mgc3BsaXQgaW50byBncm91cHMgZm9yIG11bHRpLXBhZ2UtbG9hZCBIVE1MIGZhbGxiYWNrXG5leHBvcnQgY29uc3QgTUVUUklDX0dST1VQUyA9IFtcbiAgW1xuICAgIFwiQ2x1YlNwZWVkXCIsXG4gICAgXCJCYWxsU3BlZWRcIixcbiAgICBcIlNtYXNoRmFjdG9yXCIsXG4gICAgXCJBdHRhY2tBbmdsZVwiLFxuICAgIFwiQ2x1YlBhdGhcIixcbiAgICBcIkZhY2VBbmdsZVwiLFxuICAgIFwiRmFjZVRvUGF0aFwiLFxuICAgIFwiU3dpbmdEaXJlY3Rpb25cIixcbiAgICBcIkR5bmFtaWNMb2Z0XCIsXG4gIF0sXG4gIFtcbiAgICBcIlNwaW5SYXRlXCIsXG4gICAgXCJTcGluQXhpc1wiLFxuICAgIFwiQ2FycnlcIixcbiAgICBcIlRvdGFsXCIsXG4gICAgXCJTaWRlXCIsXG4gICAgXCJTaWRlVG90YWxcIixcbiAgICBcIkhlaWdodFwiLFxuICAgIFwiTG93UG9pbnREaXN0YW5jZVwiLFxuICAgIFwiSW1wYWN0SGVpZ2h0XCIsXG4gICAgXCJJbXBhY3RPZmZzZXRcIixcbiAgICBcIlRlbXBvXCIsXG4gIF0sXG5dIGFzIGNvbnN0O1xuXG4vLyBEaXNwbGF5IG5hbWVzOiBVUkwgcGFyYW0gbmFtZSAtPiBodW1hbi1yZWFkYWJsZSBDU1YgaGVhZGVyXG5leHBvcnQgY29uc3QgTUVUUklDX0RJU1BMQVlfTkFNRVMgPSB7XG4gIENsdWJTcGVlZDogXCJDbHViIFNwZWVkXCIsXG4gIEJhbGxTcGVlZDogXCJCYWxsIFNwZWVkXCIsXG4gIFNtYXNoRmFjdG9yOiBcIlNtYXNoIEZhY3RvclwiLFxuICBBdHRhY2tBbmdsZTogXCJBdHRhY2sgQW5nbGVcIixcbiAgQ2x1YlBhdGg6IFwiQ2x1YiBQYXRoXCIsXG4gIEZhY2VBbmdsZTogXCJGYWNlIEFuZ2xlXCIsXG4gIEZhY2VUb1BhdGg6IFwiRmFjZSBUbyBQYXRoXCIsXG4gIFN3aW5nRGlyZWN0aW9uOiBcIlN3aW5nIERpcmVjdGlvblwiLFxuICBEeW5hbWljTG9mdDogXCJEeW5hbWljIExvZnRcIixcbiAgU3BpblJhdGU6IFwiU3BpbiBSYXRlXCIsXG4gIFNwaW5BeGlzOiBcIlNwaW4gQXhpc1wiLFxuICBDYXJyeTogXCJDYXJyeVwiLFxuICBUb3RhbDogXCJUb3RhbFwiLFxuICBTaWRlOiBcIlNpZGVcIixcbiAgU2lkZVRvdGFsOiBcIlNpZGUgVG90YWxcIixcbiAgSGVpZ2h0OiBcIkhlaWdodFwiLFxuICBMb3dQb2ludERpc3RhbmNlOiBcIkxvdyBQb2ludFwiLFxuICBJbXBhY3RIZWlnaHQ6IFwiSW1wYWN0IEhlaWdodFwiLFxuICBJbXBhY3RPZmZzZXQ6IFwiSW1wYWN0IE9mZnNldFwiLFxuICBUZW1wbzogXCJUZW1wb1wiLFxufTtcblxuLy8gQ1NTIGNsYXNzIHNlbGVjdG9ycyAoZnJvbSBUcmFja21hbidzIHJlbmRlcmVkIEhUTUwpXG5leHBvcnQgY29uc3QgQ1NTX0RBVEUgPSBcImRhdGVcIjtcbmV4cG9ydCBjb25zdCBDU1NfUkVTVUxUU19XUkFQUEVSID0gXCJwbGF5ZXItYW5kLXJlc3VsdHMtdGFibGUtd3JhcHBlclwiO1xuZXhwb3J0IGNvbnN0IENTU19SRVNVTFRTX1RBQkxFID0gXCJSZXN1bHRzVGFibGVcIjtcbmV4cG9ydCBjb25zdCBDU1NfQ0xVQl9UQUcgPSBcImdyb3VwLXRhZ1wiO1xuZXhwb3J0IGNvbnN0IENTU19QQVJBTV9OQU1FU19ST1cgPSBcInBhcmFtZXRlci1uYW1lcy1yb3dcIjtcbmV4cG9ydCBjb25zdCBDU1NfUEFSQU1fTkFNRSA9IFwicGFyYW1ldGVyLW5hbWVcIjtcbmV4cG9ydCBjb25zdCBDU1NfU0hPVF9ERVRBSUxfUk9XID0gXCJyb3ctd2l0aC1zaG90LWRldGFpbHNcIjtcbmV4cG9ydCBjb25zdCBDU1NfQVZFUkFHRV9WQUxVRVMgPSBcImF2ZXJhZ2UtdmFsdWVzXCI7XG5leHBvcnQgY29uc3QgQ1NTX0NPTlNJU1RFTkNZX1ZBTFVFUyA9IFwiY29uc2lzdGVuY3ktdmFsdWVzXCI7XG5cbi8vIEFQSSBVUkwgcGF0dGVybnMgdGhhdCBsaWtlbHkgaW5kaWNhdGUgYW4gQVBJIGRhdGEgcmVzcG9uc2VcbmV4cG9ydCBjb25zdCBBUElfVVJMX1BBVFRFUk5TID0gW1xuICBcImFwaS50cmFja21hbmdvbGYuY29tXCIsXG4gIFwidHJhY2ttYW5nb2xmLmNvbS9hcGlcIixcbiAgXCIvYXBpL1wiLFxuICBcIi9yZXBvcnRzL1wiLFxuICBcIi9hY3Rpdml0aWVzL1wiLFxuICBcIi9zaG90cy9cIixcbiAgXCJncmFwaHFsXCIsXG5dO1xuXG4vLyBUaW1lb3V0cyAobWlsbGlzZWNvbmRzKVxuZXhwb3J0IGNvbnN0IFBBR0VfTE9BRF9USU1FT1VUID0gMzBfMDAwO1xuZXhwb3J0IGNvbnN0IERBVEFfTE9BRF9USU1FT1VUID0gMTVfMDAwO1xuXG4vLyBUcmFja21hbiBiYXNlIFVSTFxuZXhwb3J0IGNvbnN0IEJBU0VfVVJMID0gXCJodHRwczovL3dlYi1keW5hbWljLXJlcG9ydHMudHJhY2ttYW5nb2xmLmNvbS9cIjtcblxuLy8gU3RvcmFnZSBrZXlzIGZvciBDaHJvbWUgZXh0ZW5zaW9uIChhbGlnbmVkIGJldHdlZW4gYmFja2dyb3VuZCBhbmQgcG9wdXApXG5leHBvcnQgY29uc3QgU1RPUkFHRV9LRVlTID0ge1xuICBUUkFDS01BTl9EQVRBOiBcInRyYWNrbWFuRGF0YVwiLFxufSBhcyBjb25zdDtcbiIsICIvKipcbiAqIFNlcnZpY2UgV29ya2VyIGZvciBUcmFja21hbiBTY3JhcGVyIENocm9tZSBFeHRlbnNpb25cbiAqL1xuXG5pbXBvcnQgeyBTVE9SQUdFX0tFWVMgfSBmcm9tIFwiLi4vc2hhcmVkL2NvbnN0YW50c1wiO1xuXG5jaHJvbWUucnVudGltZS5vbkluc3RhbGxlZC5hZGRMaXN0ZW5lcigoKSA9PiB7XG4gIGNvbnNvbGUubG9nKFwiVHJhY2ttYW4gU2NyYXBlciBleHRlbnNpb24gaW5zdGFsbGVkXCIpO1xufSk7XG5cbmludGVyZmFjZSBFeHBvcnRDc3ZSZXF1ZXN0IHtcbiAgdHlwZTogJ0VYUE9SVF9DU1YnO1xuICBjc3ZDb250ZW50OiBzdHJpbmc7XG4gIGZpbGVuYW1lOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBHZXREYXRhUmVxdWVzdCB7XG4gIHR5cGU6ICdHRVRfREFUQSc7XG59XG5cbmZ1bmN0aW9uIGdldERvd25sb2FkRXJyb3JNZXNzYWdlKG9yaWdpbmFsRXJyb3I6IHN0cmluZyk6IHN0cmluZyB7XG4gIGlmIChvcmlnaW5hbEVycm9yLmluY2x1ZGVzKFwiaW52YWxpZFwiKSkge1xuICAgIHJldHVybiBcIkludmFsaWQgZG93bmxvYWQgZm9ybWF0XCI7XG4gIH1cbiAgaWYgKG9yaWdpbmFsRXJyb3IuaW5jbHVkZXMoXCJxdW90YVwiKSB8fCBvcmlnaW5hbEVycm9yLmluY2x1ZGVzKFwic3BhY2VcIikpIHtcbiAgICByZXR1cm4gXCJJbnN1ZmZpY2llbnQgc3RvcmFnZSBzcGFjZVwiO1xuICB9XG4gIGlmIChvcmlnaW5hbEVycm9yLmluY2x1ZGVzKFwiYmxvY2tlZFwiKSB8fCBvcmlnaW5hbEVycm9yLmluY2x1ZGVzKFwicG9saWN5XCIpKSB7XG4gICAgcmV0dXJuIFwiRG93bmxvYWQgYmxvY2tlZCBieSBicm93c2VyIHNldHRpbmdzXCI7XG4gIH1cbiAgcmV0dXJuIG9yaWdpbmFsRXJyb3I7XG59XG5cbnR5cGUgUmVxdWVzdE1lc3NhZ2UgPSBFeHBvcnRDc3ZSZXF1ZXN0IHwgR2V0RGF0YVJlcXVlc3Q7XG5cbmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcigobWVzc2FnZTogUmVxdWVzdE1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gIGlmIChtZXNzYWdlLnR5cGUgPT09IFwiR0VUX0RBVEFcIikge1xuICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChbU1RPUkFHRV9LRVlTLlRSQUNLTUFOX0RBVEFdLCAocmVzdWx0KSA9PiB7XG4gICAgICBzZW5kUmVzcG9uc2UocmVzdWx0W1NUT1JBR0VfS0VZUy5UUkFDS01BTl9EQVRBXSB8fCBudWxsKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGlmIChtZXNzYWdlLnR5cGUgPT09ICdFWFBPUlRfQ1NWJykge1xuICAgIGNocm9tZS5kb3dubG9hZHMuZG93bmxvYWQoXG4gICAgICB7XG4gICAgICAgIHVybDogYGRhdGE6dGV4dC9jc3Y7Y2hhcnNldD11dGYtOCwke2VuY29kZVVSSUNvbXBvbmVudChtZXNzYWdlLmNzdkNvbnRlbnQpfWAsXG4gICAgICAgIGZpbGVuYW1lOiBtZXNzYWdlLmZpbGVuYW1lLFxuICAgICAgICBzYXZlQXM6IGZhbHNlLFxuICAgICAgfSxcbiAgICAgIChkb3dubG9hZElkKSA9PiB7XG4gICAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcmFja21hbiBTY3JhcGVyOiBEb3dubG9hZCBmYWlsZWQ6JywgY2hyb21lLnJ1bnRpbWUubGFzdEVycm9yKTtcbiAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBnZXREb3dubG9hZEVycm9yTWVzc2FnZShjaHJvbWUucnVudGltZS5sYXN0RXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgc2VuZFJlc3BvbnNlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvck1lc3NhZ2UgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFRyYWNrbWFuIFNjcmFwZXI6IENTViBleHBvcnRlZCB3aXRoIGRvd25sb2FkIElEICR7ZG93bmxvYWRJZH1gKTtcbiAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlLCBkb3dubG9hZElkIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufSk7XG5cbmNocm9tZS5zdG9yYWdlLm9uQ2hhbmdlZC5hZGRMaXN0ZW5lcigoY2hhbmdlcywgbmFtZXNwYWNlKSA9PiB7XG4gIGlmIChuYW1lc3BhY2UgPT09ICdsb2NhbCcgJiYgY2hhbmdlc1tTVE9SQUdFX0tFWVMuVFJBQ0tNQU5fREFUQV0pIHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IGNoYW5nZXNbU1RPUkFHRV9LRVlTLlRSQUNLTUFOX0RBVEFdLm5ld1ZhbHVlO1xuICAgIGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHsgdHlwZTogJ0RBVEFfVVBEQVRFRCcsIGRhdGE6IG5ld1ZhbHVlIH0pO1xuICB9XG59KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7QUErR08sSUFBTSxlQUFlO0FBQUEsRUFDMUIsZUFBZTtBQUNqQjs7O0FDM0dBLE9BQU8sUUFBUSxZQUFZLFlBQVksTUFBTTtBQUMzQyxVQUFRLElBQUksc0NBQXNDO0FBQ3BELENBQUM7QUFZRCxTQUFTLHdCQUF3QixlQUErQjtBQUM5RCxNQUFJLGNBQWMsU0FBUyxTQUFTLEdBQUc7QUFDckMsV0FBTztBQUFBLEVBQ1Q7QUFDQSxNQUFJLGNBQWMsU0FBUyxPQUFPLEtBQUssY0FBYyxTQUFTLE9BQU8sR0FBRztBQUN0RSxXQUFPO0FBQUEsRUFDVDtBQUNBLE1BQUksY0FBYyxTQUFTLFNBQVMsS0FBSyxjQUFjLFNBQVMsUUFBUSxHQUFHO0FBQ3pFLFdBQU87QUFBQSxFQUNUO0FBQ0EsU0FBTztBQUNUO0FBSUEsT0FBTyxRQUFRLFVBQVUsWUFBWSxDQUFDLFNBQXlCLFFBQVEsaUJBQWlCO0FBQ3RGLE1BQUksUUFBUSxTQUFTLFlBQVk7QUFDL0IsV0FBTyxRQUFRLE1BQU0sSUFBSSxDQUFDLGFBQWEsYUFBYSxHQUFHLENBQUMsV0FBVztBQUNqRSxtQkFBYSxPQUFPLGFBQWEsYUFBYSxLQUFLLElBQUk7QUFBQSxJQUN6RCxDQUFDO0FBQ0QsV0FBTztBQUFBLEVBQ1Q7QUFFQSxNQUFJLFFBQVEsU0FBUyxjQUFjO0FBQ2pDLFdBQU8sVUFBVTtBQUFBLE1BQ2Y7QUFBQSxRQUNFLEtBQUssK0JBQStCLG1CQUFtQixRQUFRLFVBQVUsQ0FBQztBQUFBLFFBQzFFLFVBQVUsUUFBUTtBQUFBLFFBQ2xCLFFBQVE7QUFBQSxNQUNWO0FBQUEsTUFDQSxDQUFDLGVBQWU7QUFDZCxZQUFJLE9BQU8sUUFBUSxXQUFXO0FBQzVCLGtCQUFRLE1BQU0sc0NBQXNDLE9BQU8sUUFBUSxTQUFTO0FBQzVFLGdCQUFNLGVBQWUsd0JBQXdCLE9BQU8sUUFBUSxVQUFVLE9BQU87QUFDN0UsdUJBQWEsRUFBRSxTQUFTLE9BQU8sT0FBTyxhQUFhLENBQUM7QUFBQSxRQUN0RCxPQUFPO0FBQ0wsa0JBQVEsSUFBSSxtREFBbUQsVUFBVSxFQUFFO0FBQzNFLHVCQUFhLEVBQUUsU0FBUyxNQUFNLFdBQVcsQ0FBQztBQUFBLFFBQzVDO0FBQUEsTUFDRjtBQUFBLElBQ0Y7QUFDQSxXQUFPO0FBQUEsRUFDVDtBQUNGLENBQUM7QUFFRCxPQUFPLFFBQVEsVUFBVSxZQUFZLENBQUMsU0FBUyxjQUFjO0FBQzNELE1BQUksY0FBYyxXQUFXLFFBQVEsYUFBYSxhQUFhLEdBQUc7QUFDaEUsVUFBTSxXQUFXLFFBQVEsYUFBYSxhQUFhLEVBQUU7QUFDckQsV0FBTyxRQUFRLFlBQVksRUFBRSxNQUFNLGdCQUFnQixNQUFNLFNBQVMsQ0FBQztBQUFBLEVBQ3JFO0FBQ0YsQ0FBQzsiLAogICJuYW1lcyI6IFtdCn0K
